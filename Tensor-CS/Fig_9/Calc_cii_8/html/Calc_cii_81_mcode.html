<pre class="code">
<span class="srcline"><span class="lineno"><a href="1,1"> 1</a></span><span class="line"><span class="keyword">function</span> [<span class="var type1" id="S2T6U3">cii</span>] = Calc_cii_8(<span class="var type1" id="S3T1U6">D1</span>,<span class="var type1" id="S4T1U7">D2</span>,<span class="var type1" id="S5T1U8">Mask</span>)</span></span>
<span class="srcline"><span class="lineno"><a href="1,2"> 2</a></span><span class="line"><span class="comment">%#codegen</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,3"> 3</a></span><span class="line"><span class="mxinfo" id="T2:U5"><span class="var type1" id="S6T2U11">I1</span> = <span class="mxinfo" id="T2:U7">size(<span class="var type1" id="S3T1U14">D1</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,4"> 4</a></span><span class="line"><span class="mxinfo" id="T2:U9"><span class="var type1" id="S8T2U18">I2</span> = <span class="mxinfo" id="T2:U11">size(<span class="var type1" id="S4T1U21">D2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,5"> 5</a></span><span class="line"><span class="mxinfo" id="T6:U13"><span class="var type1" id="S2T6U25">cii</span> = <span class="mxinfo" id="T6:U15">zeros(<span class="var type1" id="S6T2U29">I1</span>*<span class="var type1" id="S8T2U30">I2</span>,1)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,6"> 6</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,7"> 7</a></span><span class="line"><span class="comment">%mask = zeros(I1*I2,1);</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,8"> 8</a></span><span class="line"><span class="comment">%mask(sub2ind([I1,I2], ind1(1:K)', ind2(1:K)'))=1;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,9"> 9</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,10">10</a></span><span class="line"><span class="keyword">for</span> <span class="var type1" id="S10T2U34">j2</span>=<span class="mxinfo" id="T2:U19">1</span>:<span class="mxinfo" id="T2:U20"><span class="var type1" id="S8T2U37">I2</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,11">11</a></span><span class="line">    <span class="keyword">for</span> <span class="var type1" id="S11T2U40">j1</span>=<span class="mxinfo" id="T2:U23">1</span>:<span class="mxinfo" id="T2:U24"><span class="var type1" id="S6T2U43">I1</span></span></span></span>
<span class="srcline"><span class="lineno"><a href="1,12">12</a></span><span class="line">        <span class="comment">%w = kron(D2(:,j2),D1(:,j1)).*mask;</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,13">13</a></span><span class="line">        <span class="mxinfo" id="T1:U26"><span class="var type1" id="S12T1U46">W</span> = <span class="mxinfo" id="T1:U28">(<span class="mxinfo" id="T1:U29"><span class="mxinfo" id="T3:U30"><span class="var type1" id="S3T1U51">D1</span>(<span class="mxinfo" id="T19:U32">:</span>,<span class="var type1" id="S11T2U53">j1</span>)</span>*<span class="mxinfo" id="T4:U34"><span class="mxinfo" id="T3:U35"><span class="var type1" id="S4T1U56">D2</span>(<span class="mxinfo" id="T19:U37">:</span>,<span class="var type1" id="S10T2U58">j2</span>)</span>'</span></span>).*<span class="var type1" id="S5T1U59">Mask</span></span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,14">14</a></span><span class="line">        <span class="mxinfo" id="T2:U40"><span class="mxinfo" id="T2:U41"><span class="var type1" id="S2T6U63">cii</span>(<span class="mxinfo" id="T2:U43">sub2ind([<span class="var type1" id="S6T2U68">I1</span>,<span class="var type1" id="S8T2U69">I2</span>], <span class="var type1" id="S11T2U70">j1</span>, <span class="var type1" id="S10T2U71">j2</span>)</span>)</span> = <span class="mxinfo" id="T2:U48">sqrt(<span class="mxinfo" id="T2:U49">sum(<span class="mxinfo" id="T6:U50"><span class="mxinfo" id="T6:U51"><span class="var type1" id="S12T1U78">W</span>(:)</span>.^<span class="mxinfo" id="T2:U53">2</span></span>)</span>)</span></span>;</span></span>
<span class="srcline"><span class="lineno"><a href="1,15">15</a></span><span class="line">    <span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,16">16</a></span><span class="line"><span class="keyword">end</span></span></span>
<span class="srcline"><span class="lineno"><a href="1,17">17</a></span><span class="line"></span></span>
<span class="srcline"><span class="lineno"><a href="1,18">18</a></span><span class="line"><span class="keyword">end</span></span></span>
</pre>
